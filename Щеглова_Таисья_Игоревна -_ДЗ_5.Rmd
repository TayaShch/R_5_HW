---
title: "HW_5"
output: html_document
date: "2024-04-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
Задание 1:
Выводы по а - radius_mean 98.5982: Это наклон регрессионной прямой, указывающий на изменение средней площади опухоли при увеличении среднего радиуса на одну единицу. Конкретно, при увеличении среднего радиуса на 1 единицу средняя площадь опухоли увеличивается примерно на 98.6 единиц.Для обоих коэффициентов p-value < 2e-16, что гораздо меньше стандартного порога 0.05, указывая на то, что оба коэффициента значимо отличаются от 0 и, следовательно, имеют статистическую значимость в предсказании средней площади опухоли.Коэффициент детерминации R^2 равен 0.9749, что означает, что 97.49% изменчивости area_mean могут быть объяснены моделью, основанной на radius_mean. Это указывает на очень сильную связь между средним радиусом и средней площадью опухоли.

Выводы по б - radius_mean 6.88040: Это значение наклона регрессионной прямой, означающее, что при увеличении среднего радиуса на одну единицу, средний периметр опухоли увеличивается на 6.88 единиц.P-value для обоих коэффициентов меньше 2e-16, что значительно меньше стандартного порога 0.05, подтверждая, что коэффициенты значимо отличаются от 0 и важны для предсказания среднего периметра опухоли.Коэффициент детерминации R^2 равен 0.9957, указывая, что 99.57% изменчивости perimeter_mean могут быть объяснены моделью на основе radius_mean. Это указывает на очень сильную зависимость между средним радиусом и средним периметром опухоли.

Выводы по в - radius_mean 0.0011493: Наклон регрессионной линии указывает на то, что при увеличении среднего радиуса на одну единицу, средняя симметричность увеличивается примерно на 0.00115. Это означает, что практически не существует связи между средним радиусом и средней симметричностью (или она крайне незначительная). P-value для коэффициентов значительно меньше 0.05, что указывает на их статистическую значимость. Особенно это касается константы и коэффициента при radius_mean, подтверждая, что изменения в среднем радиусе статистически значимо влияют на среднюю симметричность опухоли, хотя влияние и является сравнительно небольшим. Коэффициент детерминации R^2 равен 0.02183, что означает, что только около 2.18% изменчивости symmetry_mean может быть объяснено с помощью модели, основанной на radius_mean. Это указывает на очень слабую связь между средним радиусом и средней симметричность (точнее на ее отсутствие).
```{r}
df <- read.csv("D:/Data/wisconsin_breast_cancer.csv")
df

```

```{r}
install.packages("dplyr")
install.packages("ggplot2")
library(dplyr)
library(ggplot2)
```
```{r}
# Создание регрессионной модели для среднего радиуса и средней площади
model_a <- lm(area_mean ~ radius_mean, data = df)

# Построение графика с регрессионной прямой для среднего радиуса и средней площади
ggplot(df, aes(x = radius_mean, y = area_mean)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Зависимость средней площади от среднего радиуса", x = "Средний радиус", y = "Средняя площадь")

# Выводим краткую сводку по модели
summary(model_a)

```
```{r}
# Создание регрессионной модели для среднего радиуса и среднего периметра
model_b <- lm(perimeter_mean ~ radius_mean, data = df)

# Построение графика с регрессионной прямой для среднего радиуса и среднего периметра
ggplot(df, aes(x = radius_mean, y = perimeter_mean)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Зависимость среднего периметра от среднего радиуса", x = "Средний радиус", y = "Средний периметр")

# Выводим краткую сводку по модели
summary(model_b)
```
```{r}
# Создание регрессионной модели для среднего радиуса и средней симметричности
model_c <- lm(symmetry_mean ~ radius_mean, data = df)

# Построение графика с регрессионной прямой для среднего радиуса и среднй симметричности
ggplot(df, aes(x = radius_mean, y = symmetry_mean)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Зависимость средней симметричности от среднего радиуса", x = "Средний радиус", y = "Средняя симметричность")

# Выводим краткую сводку по модели
summary(model_c)
```
Задание 2

```{r}
# Преобразование колонки с диагнозом
df$diagnosis <- ifelse(df$diagnosis == "M", 1, 0)

# Подготовка данных для модели
data_model <- df %>% select(diagnosis, radius_mean, area_mean, texture_mean)

# Создание модели логистической регрессии
model <- glm(diagnosis ~ radius_mean + area_mean + texture_mean, 
             data = data_model, family = "binomial")

# Вывод результатов модели
summary(model)

# Визуализация влияния среднего радиуса на вероятность злокачественной опухоли
ggplot(data_model, aes(x = radius_mean, y = diagnosis)) +
  geom_jitter(alpha = 0.4) +
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE, color = "red") +
  labs(title = "Влияние среднего радиуса на вероятность злокачественной опухоли",
       x = "Средний радиус",
       y = "Вероятность злокачественной опухоли")

```

```{r}
# Визуализация влияния средней площади на вероятность злокачественной опухоли
ggplot(data_model, aes(x = area_mean, y = diagnosis)) +
  geom_jitter(alpha = 0.4) +
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE, color = "red") +
  labs(title = "Влияние средней площади на вероятность злокачественной опухоли",
       x = "Средняя площадь",
       y = "Вероятность злокачественной опухоли")
```


```{r}
# Визуализация влияния средней текстуры на вероятность злокачественной опухоли
ggplot(data_model, aes(x = texture_mean, y = diagnosis)) +
  geom_jitter(alpha = 0.4) +
  geom_smooth(method = "glm", method.args = list(family = "binomial"), se = FALSE, color = "red") +
  labs(title = "Влияние средней текстуры на вероятность злокачественной опухоли",
       x = "Средняя текстура",
       y = "Вероятность злокачественной опухоли")
```

Задание 3

```{r}
# Установка и загрузка необходимых пакетов
install.packages("survival")
install.packages("survminer")

library(survival)
library(survminer)

# Загрузка датасета lung
data("lung")

# Создание переменной event
lung$event <- ifelse(lung$status == 2, 1, 0)

# Построение кривых выживаемости в зависимости от пола
surv_obj <- Surv(time = lung$time, event = lung$event)
fit <- survfit(surv_obj ~ sex, data = lung)

# Визуализация кривых выживаемости с помощью ggsurvplot
ggsurvplot(fit, data = lung, risk.table = TRUE,
           palette = c("#E7B800", "#2E9FDF"),
           pval = TRUE, conf.int = TRUE,
           legend.labs = c("Male", "Female"),
           ggtheme = theme_minimal())

# Построение графика кумулятивной функции рисков для пола
ggsurvplot(fit, data = lung, fun = "cumhaz", risk.table = TRUE,
           palette = c("#E7B800", "#2E9FDF"),
           ggtheme = theme_minimal())

# Регрессия Кокса для оценки влияния пола на выживаемость
cox_model <- coxph(surv_obj ~ sex, data = lung)
summary(cox_model)

```
Выводы по задаче - 

P-value равное 0.0013 на графике кривых выживаемости указывает на результат лог-рангового теста, сравнивающего две группы выживаемости — в данном случае, мужчин и женщин. Этот показатель статистически значим, если он меньше установленного порога (0.05), что говорит о том, что между группами существуют значимые различия в выживаемости.

Кумулятивная функция рисков: График показывает накопленный риск смерти в зависимости от времени для мужчин и женщин. Высокие значения в группе Male указывают на более высокий риск смерти среди мужчин на всем протяжении исследования.





